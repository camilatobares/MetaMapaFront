<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/base :: layout(pageTitle='Inicio', content=~{::#main-content}, pageScripts=~{::#page-scripts})}">
<body>

<main class="container-fluid p-4" id="main-content">
    <div id="alert-placeholder">
        <div th:if="${success}" class="alert alert-success d-flex align-items-center" role="alert">
            <i class="bi bi-check-circle-fill me-2 fs-5"></i>
            <span th:text="${success}"></span>
        </div>
        <div th:if="${error}" class="alert alert-danger d-flex align-items-center" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2 fs-5"></i>
            <span th:text="${error}"></span>
        </div>
    </div>
    <div class="text-center mb-5 animate__animated animate__fadeInDown">
        <h2 class="display-4 fw-bold text-primary">Información Colaborativa para un Mundo Transparente</h2>
        <p class="lead text-secondary">MetaMapa es una plataforma abierta y ciudadana para mapear, verificar y visualizar información geolocalizada.</p>
        <a th:href="@{/hechos/nuevo}" class="btn btn-primary rounded-pill px-4 py-2 fw-bold">+ Subir Hecho</a>
    </div>
    <section class="animate__animated animate__fadeIn">
        <h3 class="mb-4 text-primary fw-bold border-bottom pb-2">Explora Nuestras Colecciones</h3>
        <div class="row g-4">
            <div class="col-12" th:if="${#lists.isEmpty(colecciones)}">
                <div class="alert alert-warning">No hay colecciones para mostrar.</div>
            </div>
            <div class="col-md-6 col-lg-4" th:each="coleccion : ${colecciones}">
                <div class="card h-100 shadow-sm border-0 rounded-3 custom-card-hover">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-primary fw-bold mb-2" th:text="${coleccion.titulo}"></h5>
                        <p class="card-text text-muted flex-grow-1 mb-3" th:text="${coleccion.descripcion}"></p>
                        <div class="mb-3">
                            <small class="text-muted fw-bold"><i class="bi bi-hdd-network me-1"></i>Fuentes:</small>
                            <small class="text-secondary" th:text="${#lists.isEmpty(coleccion.fuentes) ? 'No especificadas' : #strings.listJoin(coleccion.fuentes, ', ')}"></small>
                        </div>
                        <div class="mt-auto pt-3 border-top d-grid gap-2">
                            <a th:href="@{/facts(handleId=${coleccion.handleID})}" class="btn btn-primary btn-sm rounded-pill">Ver Hechos</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<div id="page-scripts">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            renderSidebar('index');
        });
    </script>
</div>

</body>
</html>